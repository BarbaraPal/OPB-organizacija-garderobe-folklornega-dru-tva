%rebase('osnova.html', naslov='Glavna oblačila', uporabnik=uporabnisko_ime, rola = rola)
<section style="background-color: #eee;">
  <div class="container-fluid">    
    <div class="container" style="padding: 30px;">
      <div class="row">
        <div class="col-md-3">
          <strong>Vrsta:</strong> {{vrsta.ime}}
        </div>
        <div class="col-md-3">
          <strong>Pokrajina:</strong> {{vrsta.pokrajina}}
        </div>
        <div class="col-md-3">
          <strong>Spol:</strong> {{vrsta.spol}}
        </div>
        <div class="col-md-3" id ="prikazomare">
          <strong>Omara:</strong> {{vrsta.omara if vrsta.omara is not None else "/"}}
          <button type="submit" class="btn btn-secondary btn-sm showFormBtnOmara">Spremeni omaro</button>
        </div>
        <div class="col-md-3 d-flex" >
          <form id ="formomare" style="display: none;">
          <strong>Omara:</strong>                
          <input type="text" class="form-control mr-sm-2" id="inputomare" placeholder="Vnesi podatek" value="{{vrsta.omara if vrsta.omara is not None else '/'}}" name="inputomare">
          <button type="submit" class="btn btn-secondary btn-sm">Potrdi</button>
        </form>
        </div>
      </div>
    </div>
    % if str(oblacila[0])[:10] != "DodatnaObl":
        <div class="row">
          % for index, oblacilo in enumerate(oblacila):
          <div class="col-md-3 mb-4">
            <div class="card" style="width: 18rem;">
              % if oblacilo.slika is None or oblacilo.slika =='':
              <img src="/static/obesalnik.jpg" alt="Ni slike">
              % else:
              <img src="data:image/png;base64,{{ oblacilo.slika }}" alt="Slika">
              % end
              <div class="card-body" id = "card1_{{index}}"> 
                <h5 class="card-title">{{vrsta.ime}} : {{oblacilo.zaporednast}}</h5>
                <p class="card-text">Barva: {{oblacilo.barva}}</p>
                % if oblacilo.stanje == True:
                <p class="card-text">Stanje: uporabno</p>
                % else:
                <p class="card-text" style="color: red;">Stanje: ni uporabno</p>
                % end
                % if oblacilo.opombe is not None:
                <p class="card-text">Opombe: {{oblacilo.opombe}}</p>
                % end
              </div>
              <ul class="list-group list-group-flush" id = "card2_{{index}}">
                <li class="list-group-item"><b>Mere (cm)</b></li>
                % if str(oblacila[0])[:10] == "ZgornjiDel":
                <li class="list-group-item">Širina ramen: {{oblacilo.sirinaramen if oblacilo.sirinaramen is not None else '/'}}</li>
                <li class="list-group-item">Obseg prsi: {{oblacilo.obsegprsi if oblacilo.obsegprsi is not None else '/'}}</li>
                <li class="list-group-item">Dolžina rokava: {{oblacilo.dolzinarokava if oblacilo.dolzinarokava is not None else '/'}}</li>
                % elif str(oblacila[0])[:10] == "SpodnjiDel":
                <li class="list-group-item">Dolžina od pasu navzdol: {{oblacilo.dolzinaodpasunavzdol if oblacilo.dolzinaodpasunavzdol is not None else '/'}}</li>
                % elif str(oblacila[0])[:11] == "EnodelniKos":
                <li class="list-group-item">Dolžina telesa: {{oblacilo.dolzinatelesa if oblacilo.dolzinatelesa is not None else '/'}}</li>
                % end
              </ul>
              <form id = "card3_{{index}}" style="display: none;">
              <ul class="list-group list-group-flush" >
                <li class="list-group-item"><b>Stanje - spremeni</b></li>
                <li class="list-group-item">
                  <select class="custom-select mr-sm-2" id="uporabnost">
                    <option value="1" selected>uporabno</option>
                    <option value="2">neuporabno</option>
                  </select>
                </li>
                <li class="list-group-item"><b>Mere - spremeni(cm)</b></li>
                % if str(oblacila[0])[:10] == "ZgornjiDel":
                <li class="list-group-item"><label for="sirinaramen">Širina ramen:</label>
                <input type="text" class="form-control" id="sirinaramen" placeholder="Vnesi podatek" value="{{oblacilo.sirinaramen if oblacilo.sirinaramen is not None else '/'}}" name="sirinaramen"></li>
                <li class="list-group-item"><label for="obsegprsi">Obseg prsi:</label>
                <input type="text" class="form-control" id="obsegprsi" placeholder="Vnesi podatek" value="{{oblacilo.obsegprsi if oblacilo.obsegprsi is not None else '/'}}" name="obsegprsi"  ></li>
                <li class="list-group-item"><label for="dolzinarokava">Dolžina rokava:</label>
                <input type="text" class="form-control" id="dolzinarokava" placeholder="Vnesi podatek" value="{{oblacilo.dolzinarokava if oblacilo.dolzinarokava is not None else '/'}}" name="dolzinarokava"></li>
                % elif str(oblacila[0])[:10] == "SpodnjiDel":
                <li class="list-group-item"><label for="dolzinaodpasunavzdol">Dolžina od pasu navzdol:</label>
                <input type="text" class="form-control" id="dolzinaodpasunavzdol" placeholder="Vnesi podatek" value="{{oblacilo.dolzinaodpasunavzdol if oblacilo.dolzinaodpasunavzdol is not None else '/'}}" name="dolzinaodpasunavzdol"></li>
                % elif str(oblacila[0])[:11] == "EnodelniKos":
                <li class="list-group-item"><label for="enodelnikos">Dolžina telesa:</label>
                <input type="text" class="form-control" id="enodelnikos" placeholder="Vnesi podatek" value="{{oblacilo.dolzinatelesa if oblacilo.dolzinatelesa is not None else '/'}}" name="enodelnikos"></li>
                % end
              </ul>
              <button type="submit" class="btn btn-secondary">Spremeni</button>
              </form>
              <form id = "card5_{{index}}" enctype="multipart/form-data" style="display: none;">
                <ul class="list-group list-group-flush" >
                  <li class="list-group-item">
                    <div class="custom-file">
                      <input type="file" class="custom-file-input" id="validatedCustomFile1" name="slika" accept=".jpg">
                      <label class="custom-file-label" for="validatedCustomFile1">Izberi sliko...</label>
                    </div>
                  </li>
                </ul>
                <button type="submit" class="btn btn-secondary">Posodobi</button>
              </form>



            </div>
              <div class="btn-group " role="group" id = "card4_{{index}}" >
                <div class = "mr-1">
                    <button type="submit" class="btn btn-secondary btn-sm showFormBtn" id="showFormBtn" data-index="{{index}}">Uredi</button>
                </div>
                % if oblacilo.slika is not None:
                <form  class="mr-1">
                  <button type="submit" class="btn btn-secondary btn-sm showFormBtnSlika">Posodobi sliko</button>
                </form>
                % else:
                <form  class="mr-1">
                  <button type="submit" class="btn btn-secondary btn-sm showFormBtnSlika">Dodaj sliko</button>
                </form>
                % end
                <form action="{{url('izbrisi_kos_oblacila')}}" method="POST" class="needs-validation form-inline" formvalidate>
                    <input type="hidden" name="emso" value="{{id}}">
                    <button type="submit" onclick="showConfirmation()" class="btn btn-outline-danger btn-sm">Izbriši<i class="bi bi-trash3-fill"></i></button>
                </form>
            
            </div>
          </div>
          % if (index + 1) % 4 == 0: 
            </div>
            <div class="row">
            % end
          % end
        </div>
      % end
    % end
  </div>
</section>

<script>
  $(".showFormBtnOmara").click(function() {
    $("#prikazomare").hide();
    $("#formomare").show();
    $("#formomare").on("keydown", function (event) {
    // Preberite pritisnjeno tipko
    var pritisnjenaTipka = event.key;
    
    // Dovoljene so številke in znak '/'
    var dovoljeneTipke = /^[0-9\/]$/;
    // Dovoljeno brisanje
    if (pritisnjenaTipka === "Backspace" || pritisnjenaTipka === "Delete") {
      return;
    }
    // Preverite, ali je pritisnjena tipka dovoljena
    if (!dovoljeneTipke.test(pritisnjenaTipka)) {
      // Če tipka ni dovoljena, preprečimo privzeto obnašanje (vnos neveljavnega znaka)
      event.preventDefault();
    }
    });
  });
  
  $(".showFormBtn").click(function() {
    var index = $(this).data("index");
    $("#card1_" + index).hide();
    $("#card2_" + index).hide();
    $("#card4_" + index).hide();
    $("#card3_" + index).show();
    $("#card3_" + index).on("keydown", function (event) {
    // Preberite pritisnjeno tipko
    var pritisnjenaTipka = event.key;
    
    // Dovoljene so številke in znak '/'
    var dovoljeneTipke = /^[0-9\/]$/;
    // Dovoljeno brisanje
    if (pritisnjenaTipka === "Backspace" || pritisnjenaTipka === "Delete") {
      return;
    }
    // Preverite, ali je pritisnjena tipka dovoljena
    if (!dovoljeneTipke.test(pritisnjenaTipka)) {
      // Če tipka ni dovoljena, preprečimo privzeto obnašanje (vnos neveljavnega znaka)
      event.preventDefault();
    }
    });
  });


  $(".showFormBtnSlika").click(function() {
    var index = $(this).data("index");
    $("#card1_" + index).hide();
    $("#card2_" + index).hide();
    $("#card4_" + index).hide();
    $("#card5_" + index).show();
    
  });
  
</script>